library(cmdstanr)
library(vasicekreg)
source("expose_cmdstanr_funs.R")
x <- rVASIQ(n = 1, mu = 0.50, sigma = 0.69, tau = 0.50)
expose_cmdstanr_functions("vasicek.stan", expose_to_global_env = T)
stan_lpdf <- vasicek_quantile_lpdf(x, theta = 0.69, mu = 0.5, tau = 0.5)
r_lpdf <- dVASIQ(x, mu = 0.5, sigma = 0.69, log = T)
all.equal(stan_lpdf, r_lpdf)
set.seed(123)
n <- 100
x <- rbinom(n, size = 1, prob = 0.5)
eta <- 0.5 + 1 * x;
mu <- 1 / (1 + exp(-eta));
sigma <- 0.5;
y <- rVASIQ(n, mu, sigma, tau = 0.5)
data <- data.frame(y, x, tau = 0.5)
tau <- 0.5;
fit_gamlss <- gamlss::gamlss(y ~ x, data = data, family = VASIQ)
summary(fit_gamlss)
mod <- cmdstan_model("vasicek.stan")
fit_stan <- mod$sample(
data = list(N = n,
y = y,
x = x,
tau = 0.5),
refresh = 0,
show_messages = FALSE,
parallel_chains = 4
)
fit_stan$summary()
